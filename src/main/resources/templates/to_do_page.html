<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <name>To do service</name>
    <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
</head>
<body>
<p th:text="'Hello, ' + ${name} + ', this is you do page!'"/>

<div>


    <table> Tasks
        <thead>
        <tr>
            <th>name</th>
            <th>start date</th>
            <th>deadline</th>
            <th>date of completion</th>
            <th>priority</th>
        </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
    <table>
        <tbody>
        <tr>
            <td>
                <form  id="uploadTaskForm" onsubmit="">
                    <input id="name"  type="text">
                    <input id="startDate" type="text" disabled>
                    <input id="deadline" type="text">
                    <input id="dateOfCompletion" type="text">
                    <input id="priority" type="text">
                </form>
            </td>
        </tr>
        <tr>
            <td>
                <button type="submit" onclick="postTask()">Upload task</button>
            </td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        </tbody>
    </table>


</div>

<script type="text/javascript">
        var currentDate = new Date();
        var day = currentDate.getDate();
        var month = currentDate.getMonth();
        var year = currentDate.getFullYear();
        document.getElementById("startDate").value = "" + day + "-" + month + "-" + year;
        console.log("found me")
</script>

<script type="text/javascript">
        postTask = function(){
        console.log("triggered")
            // init task object
            var name = document.getElementById('name').value
            var startDate = document.getElementById('name').value
            var deadline = document.getElementById('startDate').value
            var endDate = document.getElementById('deadline').value
            var dateOfCompletion = document.getElementById('dateOfCompletion').value
            var priority = document.getElementById('priority').value

            var jsonTask = {
                        "name":name,
                        "startDate":startDate,
                        "deadline":deadline,
                        "endDate":endDate,
                        "dateOfCompletion":dateOfCompletion,
                        "priority":priority
                    }
            console.log(jsonTask)
            //send object to taskCreateHandler
            $.ajax({
             headers: {
               'Accept': 'application/json',
               'Content-Type': 'application/json'
             },
             type: "POST",
             url: "/tasks",
             data: jsonTask,
             success: function(data){
                $("#responseHtmlElement").html(data.name);
            },
             dataType: "json"
            });
        }

</script>

</body>

</html>

